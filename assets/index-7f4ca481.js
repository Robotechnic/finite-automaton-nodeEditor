var vt=Object.defineProperty;var yt=(e,t,n)=>t in e?vt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ee=(e,t,n)=>(yt(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();function L(){}function bt(e,t){for(const n in t)e[n]=t[n];return e}function st(e){return e()}function Xe(){return Object.create(null)}function Z(e){e.forEach(st)}function lt(e){return typeof e=="function"}function te(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let we;function Le(e,t){return we||(we=document.createElement("a")),we.href=t,e===we.href}function Nt(e,t){return e!=e?t==t:e!==t}function wt(e){return Object.keys(e).length===0}function ke(e,...t){if(e==null)return L;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function le(e){let t;return ke(e,n=>t=n)(),t}function R(e,t,n){e.$$.on_destroy.push(ke(t,n))}function Pt(e,t,n,o){if(e){const i=rt(e,t,n,o);return e[0](i)}}function rt(e,t,n,o){return e[1]&&o?bt(n.ctx.slice(),e[1](o(t))):n.ctx}function St(e,t,n,o){if(e[2]&&o){const i=e[2](o(n));if(t.dirty===void 0)return i;if(typeof i=="object"){const l=[],s=Math.max(t.dirty.length,i.length);for(let a=0;a<s;a+=1)l[a]=t.dirty[a]|i[a];return l}return t.dirty|i}return t.dirty}function Et(e,t,n,o,i,l){if(i){const s=rt(t,n,o,l);e.p(s,i)}}function Ct(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let o=0;o<n;o++)t[o]=-1;return t}return-1}function $e(e){return e??""}function q(e,t,n){return e.set(n),t}function N(e,t){e.appendChild(t)}function I(e,t,n){e.insertBefore(t,n||null)}function B(e){e.parentNode&&e.parentNode.removeChild(e)}function Ae(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function P(e){return document.createElement(e)}function ut(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function be(e){return document.createTextNode(e)}function O(){return be(" ")}function ct(){return be("")}function E(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function he(e){return function(t){return t.preventDefault(),e.call(this,t)}}function kt(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function De(e){return function(t){t.target===this&&e.call(this,t)}}function p(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function At(e){return Array.from(e.childNodes)}function at(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Oe(e,t){e.value=t??""}function Pe(e,t,n,o){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function X(e,t,n){e.classList[n?"add":"remove"](t)}function Dt(e,t,{bubbles:n=!1,cancelable:o=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n,o,t),i}let ve;function me(e){ve=e}function Ue(){if(!ve)throw new Error("Function called outside component initialization");return ve}function Ot(e){Ue().$$.on_mount.push(e)}function Mt(e){Ue().$$.on_destroy.push(e)}function zt(){const e=Ue();return(t,n,{cancelable:o=!1}={})=>{const i=e.$$.callbacks[t];if(i){const l=Dt(t,n,{cancelable:o});return i.slice().forEach(s=>{s.call(e,l)}),!l.defaultPrevented}return!0}}function Ye(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(o=>o.call(this,t))}const de=[],W=[],Ee=[],Ie=[],Bt=Promise.resolve();let Je=!1;function Lt(){Je||(Je=!0,Bt.then(ft))}function Te(e){Ee.push(e)}function _e(e){Ie.push(e)}const Be=new Set;let ae=0;function ft(){if(ae!==0)return;const e=ve;do{try{for(;ae<de.length;){const t=de[ae];ae++,me(t),It(t.$$)}}catch(t){throw de.length=0,ae=0,t}for(me(null),de.length=0,ae=0;W.length;)W.pop()();for(let t=0;t<Ee.length;t+=1){const n=Ee[t];Be.has(n)||(Be.add(n),n())}Ee.length=0}while(de.length);for(;Ie.length;)Ie.pop()();Je=!1,Be.clear(),me(e)}function It(e){if(e.fragment!==null){e.update(),Z(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Te)}}const Ce=new Set;let re;function qe(){re={r:0,c:[],p:re}}function Fe(){re.r||Z(re.c),re=re.p}function k(e,t){e&&e.i&&(Ce.delete(e),e.i(t))}function z(e,t,n,o){if(e&&e.o){if(Ce.has(e))return;Ce.add(e),re.c.push(()=>{Ce.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function pe(e,t,n){const o=e.$$.props[t];o!==void 0&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function $(e){e&&e.c()}function F(e,t,n,o){const{fragment:i,after_update:l}=e.$$;i&&i.m(t,n),o||Te(()=>{const s=e.$$.on_mount.map(st).filter(lt);e.$$.on_destroy?e.$$.on_destroy.push(...s):Z(s),e.$$.on_mount=[]}),l.forEach(Te)}function H(e,t){const n=e.$$;n.fragment!==null&&(Z(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Jt(e,t){e.$$.dirty[0]===-1&&(de.push(e),Lt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ne(e,t,n,o,i,l,s,a=[-1]){const c=ve;me(e);const r=e.$$={fragment:null,ctx:[],props:l,update:L,not_equal:i,bound:Xe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:Xe(),dirty:a,skip_bound:!1,root:t.target||c.$$.root};s&&s(r.root);let d=!1;if(r.ctx=n?n(e,t.props||{},(u,f,..._)=>{const h=_.length?_[0]:f;return r.ctx&&i(r.ctx[u],r.ctx[u]=h)&&(!r.skip_bound&&r.bound[u]&&r.bound[u](h),d&&Jt(e,u)),f}):[],r.update(),d=!0,Z(r.before_update),r.fragment=o?o(r.ctx):!1,t.target){if(t.hydrate){const u=At(t.target);r.fragment&&r.fragment.l(u),u.forEach(B)}else r.fragment&&r.fragment.c();t.intro&&k(e.$$.fragment),F(e,t.target,t.anchor,t.customElement),ft()}me(c)}class oe{$destroy(){H(this,1),this.$destroy=L}$on(t,n){if(!lt(n))return L;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const i=o.indexOf(n);i!==-1&&o.splice(i,1)}}$set(t){this.$$set&&!wt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Tt(e){let t,n,o,i,l;return{c(){t=P("button"),n=P("img"),Le(n.src,o=e[0])||p(n,"src",o),p(n,"alt",e[1]),p(n,"class","svelte-x6zymk"),p(t,"title",e[1]),p(t,"class","svelte-x6zymk")},m(s,a){I(s,t,a),N(t,n),i||(l=[E(t,"click",e[2]),E(t,"keypress",e[3])],i=!0)},p(s,[a]){a&1&&!Le(n.src,o=s[0])&&p(n,"src",o),a&2&&p(n,"alt",s[1]),a&2&&p(t,"title",s[1])},i:L,o:L,d(s){s&&B(t),i=!1,Z(l)}}}function jt(e,t,n){let{src:o}=t,{label:i}=t;function l(a){Ye.call(this,e,a)}function s(a){Ye.call(this,e,a)}return e.$$set=a=>{"src"in a&&n(0,o=a.src),"label"in a&&n(1,i=a.label)},[o,i,l,s]}class Se extends oe{constructor(t){super(),ne(this,t,jt,Tt,Nt,{src:0,label:1})}}const fe=[];function K(e,t=L){let n;const o=new Set;function i(a){if(te(e,a)&&(e=a,n)){const c=!fe.length;for(const r of o)r[1](),fe.push(r,e);if(c){for(let r=0;r<fe.length;r+=2)fe[r][0](fe[r+1]);fe.length=0}}}function l(a){i(a(e))}function s(a,c=L){const r=[a,c];return o.add(r),o.size===1&&(n=t(i)||L),a(e),()=>{o.delete(r),o.size===0&&(n(),n=null)}}return{set:i,update:l,subscribe:s}}class Me{constructor(t,n,o=null){ee(this,"_startPos");ee(this,"_endPos");ee(this,"_display",K(!0));ee(this,"_svgPath");ee(this,"startNode");ee(this,"endNode");this.startNode=t,this.endNode=n,this._display.set(o??(t!==null&&n!==null)),this._startPos=K({x:0,y:0}),this._endPos=K({x:0,y:0}),this._svgPath=K(this.generateSvgPath())}initialised(){return this._startPos!==null&&this._endPos!==null}mousePos(t,n=!0){this.display=n,this.startNode!==null?this.endPoint=t:this.endNode!==null&&(this.startPoint=t)}update(t,n=!1){n?this.endPoint=t:this.startPoint=t}disconnect(){this.startNode=null,this.endNode=null}setStartNode(t){this.startNode=t}setEndNode(t){this.endNode!==null&&t===null&&(this.endNode.inputConnections=this.endNode.inputConnections.filter(n=>n!==this)),this.endNode=t}getStartNode(){return this.startNode}getEndNode(){return this.endNode}getStartPos(){return this._startPos}getEndPos(){return this._endPos}getDisplay(){return this._display}get startPoint(){return le(this._startPos)}set startPoint(t){this.display&&(this._startPos.set(t),this._svgPath.set(this.generateSvgPath()))}get endPoint(){return le(this._endPos)}set endPoint(t){this.display&&(this._endPos.set(t),this._svgPath.set(this.generateSvgPath()))}get display(){return le(this._display)}set display(t){this._display.set(t)}generateSvgPath(){if(!this.initialised())return"";const t=Math.abs(this.endPoint.x-this.startPoint.x),n={x:this.startPoint.x+t*.5,y:this.startPoint.y},o={x:this.endPoint.x-t*.5,y:this.endPoint.y},i={x:this.endPoint.x,y:this.endPoint.y},l={x:this.startPoint.x+t*.1,y:this.startPoint.y};return`
			M ${this.startPoint.x} ${this.startPoint.y} 
			C ${n.x} ${n.y}, 
			  ${o.x} ${o.y},
			  ${i.x} ${i.y},
			  ${l.x} ${l.y},
			  ${this.endPoint.x} ${this.endPoint.y}
		`}getSvgPath(){return this._svgPath}}ee(Me,"connectorRadius",10);const ye=K({x:0,y:0}),Ve=K({x:0,y:0}),je=K({x:0,y:0});function Ut(){const e=K([]),{subscribe:t,set:n,update:o}=e;function i(r){return le(e).some(d=>d.name===r)}function l(){le(e).forEach(r=>{r.events.forEach(d=>{d[1]!==null&&(d[1].setEndNode(null),d[1].setStartNode(null),d[1].display=!1)})}),n([])}function s(r){return 207.5+29*r.events.length}function a(r){const d=Math.max(234,r.name.length*15.80585);let u=0;return r.events.forEach(f=>{u=Math.max(u,f[0].length*9.92335)}),d+u}function c(r){let d=!1;return o(u=>(i(r.name)||(d=!0,u.push(r)),u)),d}return{subscribe:t,set:n,update:o,hasState:i,clearStore:l,computeTheoreticalHeight:s,computeTheoreticalWidth:a,createState:c,deleteStateByName(r){o(d=>d.filter(u=>u.name!==r))},deleteState(r){o(d=>d.filter(u=>u!==r?!0:(u.inputConnections.forEach(f=>{f.setEndNode(null),f.display=!1}),u.events.forEach(f=>{f[1]!==null&&(f[1].setEndNode(null),f[1].setStartNode(null),f[1].display=!1)}),!1)))},toJSON(){return le(e).map(r=>(r.name=r.name.slice(0,20),{name:r.name,entryNode:r.entryNode,events:r.events.map(d=>{var u;return{name:d[0],action:((u=d[1].getEndNode())==null?void 0:u.name)??null}}),position:r.position}))},toAutomaton(){let r="",d="";return le(e).forEach(u=>{u.entryNode&&(d+="->"+u.name+`
`),u.events.forEach(f=>{f[1]!==null?r+=`${u.name}:${f[0]}->${f[1].getEndNode().name}
`:r+=`${u.name}:${f[0]}->${u.name}
`})}),d===""?(alert("There is no entry point for the automaton!"),null):d+r},fromJSON(r){l();const d=new Map,u={x:0,y:0};r.forEach(f=>{const _={name:f.name,entryNode:f.entryNode,events:f.events.map(h=>[h.name,null]),position:f.position,inputConnections:[]};d.set(_.name,_),c(_),u.x+=_.position.x+a(_)/2,u.y+=_.position.y+s(_)/2}),r.forEach(f=>{const _=d.get(f.name);for(let h=0;h<f.events.length;h++){const b=d.get(f.events[h].action);b!==void 0&&(_.events[h][1]=new Me(_,b),b.inputConnections.push(_.events[h][1]))}}),u.x/=r.length,u.y/=r.length,u.x*=-1,u.y*=-1,u.x+=window.innerWidth/2,u.y+=window.innerHeight/2,ye.set(u)}}}const dt=K(null),V=Ut();function ht(e,t){if(!e)return;if(e.type!=="application/json"){alert("File is not a JSON file");return}const n=new FileReader;n.onload=o=>{try{const i=JSON.parse(o.target.result);t(i)}catch(i){console.error(i),alert("Error parsing JSON file")}},n.onerror=o=>{console.error(o),alert("Error parsing JSON file")},n.readAsText(e)}function qt(e){let t,n,o,i,l,s,a,c,r;return n=new Se({props:{src:"/add.svg",label:"Add State"}}),n.$on("click",e[0]),i=new Se({props:{src:"/export.svg",label:"Save"}}),i.$on("click",e[1]),s=new Se({props:{src:"/open.svg",label:"Load"}}),s.$on("click",e[2]),c=new Se({props:{src:"/build.svg",label:"Build"}}),c.$on("click",e[3]),{c(){t=P("nav"),$(n.$$.fragment),o=O(),$(i.$$.fragment),l=O(),$(s.$$.fragment),a=O(),$(c.$$.fragment),p(t,"class","editor__navbar svelte-shcjui")},m(d,u){I(d,t,u),F(n,t,null),N(t,o),F(i,t,null),N(t,l),F(s,t,null),N(t,a),F(c,t,null),r=!0},p:L,i(d){r||(k(n.$$.fragment,d),k(i.$$.fragment,d),k(s.$$.fragment,d),k(c.$$.fragment,d),r=!0)},o(d){z(n.$$.fragment,d),z(i.$$.fragment,d),z(s.$$.fragment,d),z(c.$$.fragment,d),r=!1},d(d){d&&B(t),H(n),H(i),H(s),H(c)}}}function We(e,t,n){const o=new Blob([n],{type:t}),i=URL.createObjectURL(o),l=document.createElement("a");l.setAttribute("href",i),l.setAttribute("download",e),l.click()}function Ft(e,t,n){let o,i;R(e,ye,u=>n(5,o=u)),R(e,V,u=>n(6,i=u));const l=document.createElement("input");l.type="file",l.accept="application/json";function s(u){const f=u.target.files[0];ht(f,V.fromJSON)}Ot(()=>{l.addEventListener("change",s)}),Mt(()=>{l.removeEventListener("change",s)});function a(){const u={name:"New_State "+i.length,entryNode:i.length===0,events:[],position:{x:window.innerWidth/2-o.x,y:window.innerHeight/2-o.y},inputConnections:[]};u.position.x-=V.computeTheoreticalWidth(u)/2,u.position.y-=V.computeTheoreticalHeight(u)/2,V.createState(u)}function c(){const u=V.toJSON();We("automaton.json","application/json",JSON.stringify(u))}function r(){l.click()}function d(){const u=V.toAutomaton();u!==null&&We("automaton","text/plain",u)}return[a,c,r,d]}class Ht extends oe{constructor(t){super(),ne(this,t,Ft,qt,te,{})}}const Rt="/finite-automaton-nodeEditor/assets/trash-8bae477d.svg";function Xt(e){let t,n;const o=e[9].default,i=Pt(o,e,e[8],null);return{c(){t=P("div"),i&&i.c(),Pe(t,"--pos-x",e[0].x+"px"),Pe(t,"--pos-y",e[0].y+"px"),p(t,"class","svelte-1f65sma"),X(t,"active",e[1])},m(l,s){I(l,t,s),i&&i.m(t,null),n=!0},p(l,[s]){i&&i.p&&(!n||s&256)&&Et(i,o,l,l[8],n?St(o,l[8],s,null):Ct(l[8]),null),(!n||s&1)&&Pe(t,"--pos-x",l[0].x+"px"),(!n||s&1)&&Pe(t,"--pos-y",l[0].y+"px"),(!n||s&2)&&X(t,"active",l[1])},i(l){n||(k(i,l),n=!0)},o(l){z(i,l),n=!1},d(l){l&&B(t),i&&i.d(l)}}}function $t(e,t,n){let{$$slots:o={},$$scope:i}=t;const l=zt();let{position:s={x:0,y:0}}=t,{mouseDelta:a={x:0,y:0}}=t,{active:c=!1}=t;function r(h){n(2,a={x:h.clientX-s.x,y:h.clientY-s.y}),n(1,c=!0)}function d(){return s}function u(){return c}function f(h,b){n(0,s={x:h-a.x,y:b-a.y}),l("move",s)}function _(h){n(1,c=!1)}return e.$$set=h=>{"position"in h&&n(0,s=h.position),"mouseDelta"in h&&n(2,a=h.mouseDelta),"active"in h&&n(1,c=h.active),"$$scope"in h&&n(8,i=h.$$scope)},[s,c,a,r,d,u,f,_,i,o]}class _t extends oe{constructor(t){super(),ne(this,t,$t,Xt,te,{position:0,mouseDelta:2,active:1,mouseDown:3,getPosition:4,isActive:5,newMousePos:6,mouseUp:7})}get mouseDown(){return this.$$.ctx[3]}get getPosition(){return this.$$.ctx[4]}get isActive(){return this.$$.ctx[5]}get newMousePos(){return this.$$.ctx[6]}get mouseUp(){return this.$$.ctx[7]}}const j=K(null),pt=new Image;pt.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Yt(e){let t,n,o,i,l;return{c(){t=P("div"),n=be(" "),p(t,"class",o=$e(e[0])+" svelte-sapybo"),p(t,"draggable","true"),X(t,"active",e[2])},m(s,a){I(s,t,a),N(t,n),e[14](t),i||(l=[E(t,"dragend",he(e[6])),E(t,"drag",e[4]),E(t,"dragstart",e[3]),E(t,"dragover",he(e[15])),E(t,"dragleave",he(e[16])),E(t,"dragenter",he(e[17])),E(t,"drop",e[5])],i=!0)},p(s,[a]){a&1&&o!==(o=$e(s[0])+" svelte-sapybo")&&p(t,"class",o),a&5&&X(t,"active",s[2])},i:L,o:L,d(s){s&&B(t),e[14](null),i=!1,Z(l)}}}function Vt(e,t,n){let o,i,l;R(e,j,y=>n(18,o=y)),R(e,je,y=>n(19,i=y)),R(e,ye,y=>n(20,l=y));let s=null,{eventName:a}=t,{parentNode:c}=t,{connection:r=null}=t,{position:d}=t,u=!1;function f(y){c.events.map(C=>(C[0]===a&&(C[1]=y),C))}function _(y){n(7,c.inputConnections=c.inputConnections.filter(C=>C!==y),c)}function h(){if(s===null)return;const y=s.getBoundingClientRect();return{x:y.x+y.width/2-l.x,y:y.y+y.height/2-l.y}}function b(){const y=h();if(y)if(d==="right"){if(r===null||r[1]===null)return;r[1].update(y,!1)}else c.inputConnections.forEach(C=>{C.update(y,!0)})}function U(y){y.dataTransfer.setDragImage(pt,0,0);const C=h();return d==="left"?(c.inputConnections.length==0?(q(j,o=new Me(null,c),o),console.log("Init left connection",C)):(q(j,o=c.inputConnections[c.inputConnections.length-1],o),o.setEndNode(null),console.log("Break a right connection",C)),!1):(q(j,o=r[1],o),o.setStartNode(c),o.setEndNode(null),console.log("Init right connection",C),q(j,o.display=!0,o),o.update({x:C.x,y:C.y},!0),o.update({x:C.x,y:C.y},!1),!1)}function w(){o!==null&&o.mousePos(i)}function J(){o!==null&&(o.getStartNode()!==null&&d==="left"?(console.log("Connection successfully created right to left"),o.setEndNode(c),o.update(h(),!0),c.inputConnections.push(o)):o.getEndNode()!==null&&d==="right"?(console.log("Connection successfully created left to right"),o.setStartNode(c),o.update(h(),!1)):(console.log("Connection cancelled"),q(j,o.display=!1,o)),q(j,o=null,o),n(2,u=!1))}function M(){o!==null&&(console.log("Connection cancelled"),q(j,o.display=!1,o),q(j,o=null,o))}function Y(y){W[y?"unshift":"push"](()=>{s=y,n(1,s)})}const x=()=>{n(2,u=!0)},v=()=>{n(2,u=!1)},g=()=>{n(2,u=!0)};return e.$$set=y=>{"eventName"in y&&n(8,a=y.eventName),"parentNode"in y&&n(7,c=y.parentNode),"connection"in y&&n(9,r=y.connection),"position"in y&&n(0,d=y.position)},e.$$.update=()=>{e.$$.dirty&128&&(c.position,b())},[d,s,u,U,w,J,M,c,a,r,f,_,h,b,Y,x,v,g]}class gt extends oe{constructor(t){super(),ne(this,t,Vt,Yt,te,{eventName:8,parentNode:7,connection:9,position:0,addConnection:10,removeInputConnection:11,getPos:12,update:13})}get addConnection(){return this.$$.ctx[10]}get removeInputConnection(){return this.$$.ctx[11]}get getPos(){return this.$$.ctx[12]}get update(){return this.$$.ctx[13]}}function Ge(e){let t;return{c(){t=ut("path"),p(t,"d",e[6]),p(t,"stroke",e[0]),p(t,"stroke-linecap",e[1]),p(t,"stroke-width",e[2]),p(t,"fill","none")},m(n,o){I(n,t,o)},p(n,o){o&64&&p(t,"d",n[6]),o&1&&p(t,"stroke",n[0]),o&2&&p(t,"stroke-linecap",n[1]),o&4&&p(t,"stroke-width",n[2])},d(n){n&&B(t)}}}function Wt(e){let t,n=e[5]&&Ge(e);return{c(){n&&n.c(),t=ct()},m(o,i){n&&n.m(o,i),I(o,t,i)},p(o,[i]){o[5]?n?n.p(o,i):(n=Ge(o),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:L,o:L,d(o){n&&n.d(o),o&&B(t)}}}function Gt(e,t,n){let o,i=L,l=()=>(i(),i=ke(h,b=>n(5,o=b)),h),s,a=L,c=()=>(a(),a=ke(_,b=>n(6,s=b)),_);e.$$.on_destroy.push(()=>i()),e.$$.on_destroy.push(()=>a());let{connection:r}=t,{color:d="black"}=t,{lineCap:u="round"}=t,{lineStroke:f=2}=t,_=r==null?void 0:r.getSvgPath();c();let h=r==null?void 0:r.getDisplay();return l(),e.$$set=b=>{"connection"in b&&n(7,r=b.connection),"color"in b&&n(0,d=b.color),"lineCap"in b&&n(1,u=b.lineCap),"lineStroke"in b&&n(2,f=b.lineStroke)},e.$$.update=()=>{e.$$.dirty&128&&(c(n(3,_=r==null?void 0:r.getSvgPath())),l(n(4,h=r==null?void 0:r.getDisplay())))},[d,u,f,_,h,o,s,r]}class Qt extends oe{constructor(t){super(),ne(this,t,Gt,Wt,te,{connection:7,color:0,lineCap:1,lineStroke:2})}}function Qe(e,t,n){const o=e.slice();return o[19]=t[n],o}function Ke(e,t,n){const o=e.slice();return o[22]=t[n],o[23]=t,o[24]=n,o}function Ze(e,t,n){const o=e.slice();return o[22]=t[n],o[25]=t,o[24]=n,o}function Kt(e){let t=e[0].name+"",n;return{c(){n=be(t)},m(o,i){I(o,n,i)},p(o,i){i&1&&t!==(t=o[0].name+"")&&at(n,t)},d(o){o&&B(n)}}}function Zt(e){let t;return{c(){t=P("span"),t.textContent="Invalid name",p(t,"class","invalid svelte-hz544v")},m(n,o){I(n,t,o)},p:L,d(n){n&&B(t)}}}function xe(e){let t,n,o,i,l,s,a,c,r;function d(){e[11].call(n,e[25],e[24])}function u(){return e[12](e[24])}return{c(){t=P("div"),n=P("input"),o=O(),i=P("button"),l=P("img"),a=O(),p(n,"type","text"),p(n,"name","outputs"),p(n,"id","outputs"),p(n,"class","svelte-hz544v"),X(n,"invalid",e[0].events.length===0),Le(l.src,s=Rt)||p(l,"src",s),p(l,"alt","trash"),p(l,"class","svelte-hz544v"),p(i,"class","svelte-hz544v"),p(t,"class","node__outputs__events svelte-hz544v")},m(f,_){I(f,t,_),N(t,n),Oe(n,e[22][0]),N(t,o),N(t,i),N(i,l),N(t,a),c||(r=[E(n,"input",d),E(i,"click",u)],c=!0)},p(f,_){e=f,_&1&&n.value!==e[22][0]&&Oe(n,e[22][0]),_&1&&X(n,"invalid",e[0].events.length===0)},d(f){f&&B(t),c=!1,Z(r)}}}function et(e){let t,n,o=e[22][0]+"",i,l,s,a,c,r,d,u,f;function _(w){e[13](w,e[22])}function h(w){e[14](w,e[22],e[23],e[24])}function b(w){e[15](w)}let U={position:"right"};return e[22][0]!==void 0&&(U.eventName=e[22][0]),e[22]!==void 0&&(U.connection=e[22]),e[0]!==void 0&&(U.parentNode=e[0]),s=new gt({props:U}),W.push(()=>pe(s,"eventName",_)),W.push(()=>pe(s,"connection",h)),W.push(()=>pe(s,"parentNode",b)),{c(){t=P("div"),n=P("span"),i=be(o),l=O(),$(s.$$.fragment),d=O(),p(n,"class","svelte-hz544v"),p(t,"class","node__outputsConnectors__connector svelte-hz544v"),p(t,"id",u="connector-"+(e[0].name+e[22][0]+e[24]))},m(w,J){I(w,t,J),N(t,n),N(n,i),N(t,l),F(s,t,null),N(t,d),f=!0},p(w,J){e=w,(!f||J&1)&&o!==(o=e[22][0]+"")&&at(i,o);const M={};!a&&J&1&&(a=!0,M.eventName=e[22][0],_e(()=>a=!1)),!c&&J&1&&(c=!0,M.connection=e[22],_e(()=>c=!1)),!r&&J&1&&(r=!0,M.parentNode=e[0],_e(()=>r=!1)),s.$set(M),(!f||J&1&&u!==(u="connector-"+(e[0].name+e[22][0]+e[24])))&&p(t,"id",u)},i(w){f||(k(s.$$.fragment,w),f=!0)},o(w){z(s.$$.fragment,w),f=!1},d(w){w&&B(t),H(s)}}}function xt(e){let t,n,o,i,l,s,a,c,r,d,u,f,_,h,b,U,w,J,M,Y,x,v,g,y,C,ue,ie,ze,He;n=new gt({props:{position:"left",eventName:"input",parentNode:e[0]}});function Re(m,A){return m[0].name.length===0?Zt:Kt}let Ne=Re(e),G=Ne(e),ce=e[0].events,T=[];for(let m=0;m<ce.length;m+=1)T[m]=xe(Ze(e,ce,m));let se=e[0].events,D=[];for(let m=0;m<se.length;m+=1)D[m]=et(Ke(e,se,m));const mt=m=>z(D[m],1,1,()=>{D[m]=null});return{c(){t=P("div"),$(n.$$.fragment),o=O(),i=P("h2"),G.c(),l=O(),s=P("button"),s.textContent="Delete this node",a=O(),c=P("div"),r=P("label"),r.textContent="Entry node:",d=O(),u=P("input"),_=O(),h=P("div"),b=P("label"),b.textContent="Name:",U=O(),w=P("input"),J=O(),M=P("div"),Y=P("label"),Y.textContent="Outputs events:",x=O(),v=P("button"),v.textContent="Add",g=O();for(let m=0;m<T.length;m+=1)T[m].c();y=O(),C=P("div");for(let m=0;m<D.length;m+=1)D[m].c();p(i,"class","svelte-hz544v"),p(s,"class","node__delete svelte-hz544v"),p(r,"for","entryNode"),p(r,"class","svelte-hz544v"),p(u,"type","radio"),p(u,"name","entryNode"),u.__value=f="entryNoode-"+e[0].name,u.value=u.__value,e[9][0].push(u),p(c,"class","node_entryNode"),p(b,"for","name"),p(b,"class","svelte-hz544v"),p(w,"type","text"),p(w,"name","name"),p(w,"id","name"),p(w,"class","svelte-hz544v"),X(w,"invalid",e[0].name.length===0),p(h,"class","node__name"),p(Y,"for","outputs"),p(Y,"class","svelte-hz544v"),p(v,"class","svelte-hz544v"),p(M,"class","node__outputs svelte-hz544v"),p(C,"class","node__outputsConnectors svelte-hz544v"),p(t,"class","node svelte-hz544v"),p(t,"id",ue="node-"+e[0].name)},m(m,A){I(m,t,A),F(n,t,null),N(t,o),N(t,i),G.m(i,null),N(t,l),N(t,s),N(t,a),N(t,c),N(c,r),N(c,d),N(c,u),u.checked=u.__value===e[1],N(t,_),N(t,h),N(h,b),N(h,U),N(h,w),Oe(w,e[0].name),N(t,J),N(t,M),N(M,Y),N(M,x),N(M,v),N(M,g);for(let Q=0;Q<T.length;Q+=1)T[Q].m(M,null);N(t,y),N(t,C);for(let Q=0;Q<D.length;Q+=1)D[Q].m(C,null);ie=!0,ze||(He=[E(s,"click",e[7]),E(u,"change",e[8]),E(w,"input",e[10]),E(v,"click",e[5]),E(t,"mousedown",De(e[3])),E(t,"mouseup",De(e[4]))],ze=!0)},p(m,A){const Q={};if(A&1&&(Q.parentNode=m[0]),n.$set(Q),Ne===(Ne=Re(m))&&G?G.p(m,A):(G.d(1),G=Ne(m),G&&(G.c(),G.m(i,null))),(!ie||A&1&&f!==(f="entryNoode-"+m[0].name))&&(u.__value=f,u.value=u.__value),A&2&&(u.checked=u.__value===m[1]),A&1&&w.value!==m[0].name&&Oe(w,m[0].name),(!ie||A&1)&&X(w,"invalid",m[0].name.length===0),A&65){ce=m[0].events;let S;for(S=0;S<ce.length;S+=1){const ge=Ze(m,ce,S);T[S]?T[S].p(ge,A):(T[S]=xe(ge),T[S].c(),T[S].m(M,null))}for(;S<T.length;S+=1)T[S].d(1);T.length=ce.length}if(A&1){se=m[0].events;let S;for(S=0;S<se.length;S+=1){const ge=Ke(m,se,S);D[S]?(D[S].p(ge,A),k(D[S],1)):(D[S]=et(ge),D[S].c(),k(D[S],1),D[S].m(C,null))}for(qe(),S=se.length;S<D.length;S+=1)mt(S);Fe()}(!ie||A&1&&ue!==(ue="node-"+m[0].name))&&p(t,"id",ue)},i(m){if(!ie){k(n.$$.fragment,m);for(let A=0;A<se.length;A+=1)k(D[A]);ie=!0}},o(m){z(n.$$.fragment,m),D=D.filter(Boolean);for(let A=0;A<D.length;A+=1)z(D[A]);ie=!1},d(m){m&&B(t),H(n),G.d(),e[9][0].splice(e[9][0].indexOf(u),1),Ae(T,m),Ae(D,m),ze=!1,Z(He)}}}function tt(e){let t,n;return t=new Qt({props:{connection:e[19][1]}}),{c(){$(t.$$.fragment)},m(o,i){F(t,o,i),n=!0},p(o,i){const l={};i&1&&(l.connection=o[19][1]),t.$set(l)},i(o){n||(k(t.$$.fragment,o),n=!0)},o(o){z(t.$$.fragment,o),n=!1},d(o){H(t,o)}}}function en(e){let t,n,o,i,l;function s(u){e[17](u)}let a={$$slots:{default:[xt]},$$scope:{ctx:e}};e[0].position!==void 0&&(a.position=e[0].position),t=new _t({props:a}),e[16](t),W.push(()=>pe(t,"position",s));let c=e[0].events,r=[];for(let u=0;u<c.length;u+=1)r[u]=tt(Qe(e,c,u));const d=u=>z(r[u],1,1,()=>{r[u]=null});return{c(){$(t.$$.fragment),o=O(),i=ut("svg");for(let u=0;u<r.length;u+=1)r[u].c();p(i,"class","svelte-hz544v")},m(u,f){F(t,u,f),I(u,o,f),I(u,i,f);for(let _=0;_<r.length;_+=1)r[_].m(i,null);l=!0},p(u,[f]){const _={};if(f&67108867&&(_.$$scope={dirty:f,ctx:u}),!n&&f&1&&(n=!0,_.position=u[0].position,_e(()=>n=!1)),t.$set(_),f&1){c=u[0].events;let h;for(h=0;h<c.length;h+=1){const b=Qe(u,c,h);r[h]?(r[h].p(b,f),k(r[h],1)):(r[h]=tt(b),r[h].c(),k(r[h],1),r[h].m(i,null))}for(qe(),h=c.length;h<r.length;h+=1)d(h);Fe()}},i(u){if(!l){k(t.$$.fragment,u);for(let f=0;f<c.length;f+=1)k(r[f]);l=!0}},o(u){z(t.$$.fragment,u),r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)z(r[f]);l=!1},d(u){e[16](null),H(t,u),u&&B(o),u&&B(i),Ae(r,u)}}}function nt(e){return e.length===0?[!1,""]:e.includes(" ")?[!1,e.replace(" ","_")]:e.length>20?[!1,e.slice(0,20)]:[!0,e]}function tn(e,t,n){let o;R(e,j,v=>n(18,o=v));let i=null,{value:l}=t,s="";function a(v){dt.set({isActive:i.isActive,newMousePos:i.newMousePos}),i.mouseDown(v)}function c(v){i.mouseUp(v),o&&(q(j,o.display=!1,o),q(j,o=null,o))}function r(){n(0,l.events=[...l.events,[String(l.events.length),new Me(null,null)]],l)}function d(v){l.events[v][1].setEndNode(null),n(0,l.events=l.events.slice(0,v).concat(l.events.slice(v+1)),l)}function u(){confirm("Are you sure you want to delete this node?")&&V.deleteState(l)}const f=[[]];function _(){s=this.__value,n(1,s)}function h(){l.name=this.value,n(0,l),n(1,s)}function b(v,g){v[g][0]=this.value,n(0,l),n(1,s)}const U=v=>d(v);function w(v,g){e.$$.not_equal(g[0],v)&&(g[0]=v,n(0,l),n(1,s))}function J(v,g,y,C){y[C]=v,n(0,l),n(1,s)}function M(v){l=v,n(0,l),n(1,s)}function Y(v){W[v?"unshift":"push"](()=>{i=v,n(2,i)})}function x(v){e.$$.not_equal(l.position,v)&&(l.position=v,n(0,l),n(1,s))}return e.$$set=v=>{"value"in v&&n(0,l=v.value)},e.$$.update=()=>{if(e.$$.dirty&3&&n(0,l.entryNode=s==="entryNoode-"+l.name,l),e.$$.dirty&1){const[v,g]=nt(l.name);!v&&g.length>0&&n(0,l.name=g,l)}e.$$.dirty&1&&l.events.forEach(v=>{const[g,y]=nt(v[0]);!g&&y.length>0&&(v[0]=y)})},[l,s,i,a,c,r,d,u,_,f,h,b,U,w,J,M,Y,x]}class nn extends oe{constructor(t){super(),ne(this,t,tn,en,te,{value:0})}}function ot(e,t,n){const o=e.slice();return o[20]=t[n],o[21]=t,o[22]=n,o}function it(e){let t,n,o;function i(s){e[13](s,e[20],e[21],e[22])}let l={};return e[20]!==void 0&&(l.value=e[20]),t=new nn({props:l}),W.push(()=>pe(t,"value",i)),{c(){$(t.$$.fragment)},m(s,a){F(t,s,a),o=!0},p(s,a){e=s;const c={};!n&&a&16&&(n=!0,c.value=e[20],_e(()=>n=!1)),t.$set(c)},i(s){o||(k(t.$$.fragment,s),o=!0)},o(s){z(t.$$.fragment,s),o=!1},d(s){H(t,s)}}}function on(e){let t,n,o=e[4],i=[];for(let s=0;s<o.length;s+=1)i[s]=it(ot(e,o,s));const l=s=>z(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();t=ct()},m(s,a){for(let c=0;c<i.length;c+=1)i[c].m(s,a);I(s,t,a),n=!0},p(s,a){if(a&16){o=s[4];let c;for(c=0;c<o.length;c+=1){const r=ot(s,o,c);i[c]?(i[c].p(r,a),k(i[c],1)):(i[c]=it(r),i[c].c(),k(i[c],1),i[c].m(t.parentNode,t))}for(qe(),c=o.length;c<i.length;c+=1)l(c);Fe()}},i(s){if(!n){for(let a=0;a<o.length;a+=1)k(i[a]);n=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)z(i[a]);n=!1},d(s){Ae(i,s),s&&B(t)}}}function sn(e){let t,n,o,i,l,s,a,c,r,d;i=new Ht({});function u(_){e[15](_)}let f={$$slots:{default:[on]},$$scope:{ctx:e}};return e[3]!==void 0&&(f.position=e[3]),s=new _t({props:f}),e[14](s),W.push(()=>pe(s,"position",u)),{c(){t=P("section"),t.innerHTML='<div class="fileDragOverlay__content svelte-nmbowb"><h1>Drop your file here to open it</h1></div>',n=O(),o=P("section"),$(i.$$.fragment),l=O(),$(s.$$.fragment),p(t,"class","fileDragOverlay svelte-nmbowb"),X(t,"active",e[2]),p(o,"class","editor svelte-nmbowb"),X(o,"active",e[1])},m(_,h){I(_,t,h),I(_,n,h),I(_,o,h),F(i,o,null),N(o,l),F(s,o,null),c=!0,r||(d=[E(window,"mousemove",e[5]),E(window,"dragenter",e[10]),E(window,"dragleave",e[11]),E(window,"dragover",e[5]),E(t,"drop",kt(he(e[9]))),E(t,"dragover",he(e[12])),E(o,"mousemove",e[6]),E(o,"mousedown",De(e[7])),E(o,"mouseup",De(e[8]))],r=!0)},p(_,[h]){(!c||h&4)&&X(t,"active",_[2]);const b={};h&8388624&&(b.$$scope={dirty:h,ctx:_}),!a&&h&8&&(a=!0,b.position=_[3],_e(()=>a=!1)),s.$set(b),(!c||h&2)&&X(o,"active",_[1])},i(_){c||(k(i.$$.fragment,_),k(s.$$.fragment,_),c=!0)},o(_){z(i.$$.fragment,_),z(s.$$.fragment,_),c=!1},d(_){_&&B(t),_&&B(n),_&&B(o),H(i),e[14](null),H(s),r=!1,Z(d)}}}function ln(e,t,n){let o,i,l,s,a,c;R(e,j,g=>n(16,o=g)),R(e,ye,g=>n(3,i=g)),R(e,dt,g=>n(17,l=g)),R(e,je,g=>n(18,s=g)),R(e,Ve,g=>n(19,a=g)),R(e,V,g=>n(4,c=g));let r=null,d=!1,u=!1;function f(g){q(Ve,a={x:g.clientX,y:g.clientY},a),q(je,s={x:g.clientX-i.x,y:g.clientY-i.y},s)}function _(g){if(l!=null&&l.isActive()){l.newMousePos(g.clientX,g.clientY);return}if(r.isActive()){r.newMousePos(g.clientX,g.clientY);return}o!==null&&o.mousePos({x:g.clientX-i.x,y:g.clientY-i.y},o.display)}function h(g){n(1,d=!0),r.mouseDown(g)}function b(g){n(1,d=!1),r.mouseUp(g),o!==null&&(console.log("connection cancelled"),q(j,o=null,o))}function U(g){n(2,u=!1);const y=g.dataTransfer.files[0];ht(y,V.fromJSON)}function w(g){g.dataTransfer.types.includes("Files")&&n(2,u=!0)}function J(g){n(2,u=!1)}const M=g=>n(2,u=!0);function Y(g,y,C,ue){C[ue]=g,V.set(c)}function x(g){W[g?"unshift":"push"](()=>{r=g,n(0,r)})}function v(g){i=g,ye.set(i)}return[r,d,u,i,c,f,_,h,b,U,w,J,M,Y,x,v]}class rn extends oe{constructor(t){super(),ne(this,t,ln,sn,te,{})}}function un(e){let t,n,o,i,l;return i=new rn({}),{c(){t=P("main"),n=P("header"),n.innerHTML=`<h1 class="svelte-1mo23u5">Finite automaton editor</h1> 
	<nav class="svelte-1mo23u5"><a href="https://github.com/Robotechnic/finite-automaton" class="svelte-1mo23u5">About the language</a> 
		<a href="http://github.com" class="svelte-1mo23u5">Git Hub</a></nav>`,o=O(),$(i.$$.fragment),p(n,"class","svelte-1mo23u5")},m(s,a){I(s,t,a),N(t,n),N(t,o),F(i,t,null),l=!0},p:L,i(s){l||(k(i.$$.fragment,s),l=!0)},o(s){z(i.$$.fragment,s),l=!1},d(s){s&&B(t),H(i)}}}class cn extends oe{constructor(t){super(),ne(this,t,null,un,te,{})}}new cn({target:document.getElementById("app")});
